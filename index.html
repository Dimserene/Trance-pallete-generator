<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Trance Palette Generator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Include jscolor library -->
    <script src="https://jscolor.com/releases/2.4.5/jscolor.js"></script>
    <style>
        /* General Styles */
        body {
            font-family: Arial, sans-serif;
            background-color: #f4f4f4;
            text-align: center;
            padding: 10px;
            margin: 0;
        }
        h1 {
            margin-top: 20px;
            font-size: 1.5em;
        }
        .palette-group {
            margin: 20px 0;
        }
        .group-title {
            font-size: 1.2em;
            margin-bottom: 10px;
            text-decoration: underline;
        }
        .palette-item {
            display: flex;
            flex-wrap: nowrap;
            justify-content: center;
            align-items: center;
            margin: 10px 0;
        }
        .palette-item > div, .palette-item > span, .palette-item > input {
            margin: 5px;
        }
        .subtitle {
            font-weight: bold;
            min-width: 80px;
        }
        .default-color, .new-color {
            display: inline-block;
            width: 100px;
            padding: 10px;
            color: #fff;
            font-weight: bold;
            border-radius: 5px;
            text-align: center;
            cursor: pointer;
        }
        .palette-item input[type="text"] {
            width: 100px;
            padding: 10px;
            border: none;
            text-align: center;
            font-weight: bold;
            color: #fff;
            border-radius: 5px;
            cursor: pointer;
        }
        .palette-item input[type="text"].jscolor {
            padding: 0;
            background: none;
        }
        button {
            margin-top: 20px;
            padding: 15px 25px;
            font-size: 1em;
            cursor: pointer;
            border: none;
            background-color: #374244;
            color: #fff;
            border-radius: 5px;
        }
        button:hover {
            background-color: #4f6367;
        }
        /* Responsive adjustments */
        @media (max-width: 600px) {
            h1 {
                font-size: 1.2em;
            }
            .subtitle, .default-color, .new-color, .palette-item input[type="text"] {
                width: 80px;
                font-size: 0.9em;
                padding: 8px;
            }
            .palette-item {
                flex-wrap: wrap;
            }
            button {
                padding: 12px 20px;
                font-size: 0.9em;
            }
        }
    </style>
</head>
<body>
    <h1>Trance Palette Generator</h1>

    <div id="palette-container">
        <!-- Main Colors -->
        <div class="palette-group">
            <div class="group-title">Main Colors</div>
            <!-- SPLASH -->
            <div class="palette-item">
                <div class="subtitle">SPLASH</div>
                <span class="default-color" style="background-color: #FE5F55;">#FE5F55</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'SPLASH'}" style="background-color: #FE5F55;">#FE5F55</span>
            </div>
            <!-- MULT -->
            <div class="palette-item">
                <div class="subtitle">MULT</div>
                <span class="default-color" style="background-color: #FE5F55;">#FE5F55</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'MULT'}" style="background-color: #FE5F55;">#FE5F55</span>
            </div>
            <!-- CHIPS -->
            <div class="palette-item">
                <div class="subtitle">CHIPS</div>
                <span class="default-color" style="background-color: #009DFF;">#009DFF</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'CHIPS'}" style="background-color: #009DFF;">#009DFF</span>
            </div>
            <!-- PLASMA -->
            <div class="palette-item">
                <div class="subtitle">PLASMA</div>
                <span class="default-color" style="background-color: #CC73D9;">#CC73D9</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'PLASMA'}" style="background-color: #CC73D9;">#CC73D9</span>
            </div>
            <!-- MONEY -->
            <div class="palette-item">
                <div class="subtitle">MONEY</div>
                <span class="default-color" style="background-color: #F3B958;">#F3B958</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'MONEY'}" style="background-color: #F3B958;">#F3B958</span>
            </div>
            <!-- Continue adding other main colors similarly -->
        </div>

        <!-- UI Colors -->
        <div class="palette-group">
            <div class="group-title">UI Colors</div>
            <!-- TEXT_LIGHT -->
            <div class="palette-item">
                <div class="subtitle">TEXT_LIGHT</div>
                <span class="default-color" style="background-color: #FFFFFF;">#FFFFFF</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'UI_TEXT_LIGHT'}" style="background-color: #FFFFFF;">#FFFFFF</span>
            </div>
            <!-- TEXT_DARK -->
            <div class="palette-item">
                <div class="subtitle">TEXT_DARK</div>
                <span class="default-color" style="background-color: #4F6367;">#4F6367</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'UI_TEXT_DARK'}" style="background-color: #4F6367;">#4F6367</span>
            </div>
            <!-- Continue with other UI colors... -->
        </div>

        <!-- BOSSES Colors -->
        <div class="palette-group">
            <div class="group-title">Bosses Colors</div>
            <!-- bl_ox -->
            <div class="palette-item">
                <div class="subtitle">bl_ox</div>
                <span class="default-color" style="background-color: #B95B08;">#B95B08</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'BOSSES_bl_ox'}" style="background-color: #B95B08;">#B95B08</span>
            </div>
            <!-- Add other BOSSES colors similarly -->
        </div>

        <!-- SET Colors -->
        <div class="palette-group">
            <div class="group-title">Set Colors</div>
            <!-- Default -->
            <div class="palette-item">
                <div class="subtitle">Default</div>
                <span class="default-color" style="background-color: #CDD9DC;">#CDD9DC</span>
                <span class="new-color jscolor" data-jscolor="{onFineChange:'updateColor(this)', valueElement: 'SET_Default'}" style="background-color: #CDD9DC;">#CDD9DC</span>
            </div>
            <!-- Add other SET colors similarly -->
        </div>

        <!-- Continue adding groups for other categories like SECONDARY_SET, RARITY, SO_1, SO_2, etc. -->

    </div>

    <!-- Button to Export the Palette -->
    <button onclick="exportPalette()">Export Palette</button>

    <script>
        // Function to update the new color and background
        function updateColor(picker) {
            const colorId = picker.valueElement;
            const newColorSpan = picker;
            const colorValue = '#' + picker.jscolor.toHEXString().toUpperCase();
            newColorSpan.style.backgroundColor = colorValue;
            newColorSpan.textContent = colorValue;
            picker.style.backgroundColor = colorValue;
            picker.style.color = getContrastingColor(colorValue);
        }

        // Function to get contrasting text color (black or white)
        function getContrastingColor(hexColor) {
            const r = parseInt(hexColor.substr(1,2),16);
            const g = parseInt(hexColor.substr(3,2),16);
            const b = parseInt(hexColor.substr(5,2),16);
            const brightness = (r * 299 + g * 587 + b * 114) / 1000;
            return brightness > 125 ? '#000' : '#fff';
        }

        // Function to export the palette as a Lua file
        function exportPalette() {
            // Build the palette object with nested structure
            const palette = {
                SPLASH: document.querySelector('.new-color[data-jscolor*="SPLASH"]').jscolor.toHEXString().toUpperCase(),
                MULT: document.querySelector('.new-color[data-jscolor*="MULT"]').jscolor.toHEXString().toUpperCase(),
                CHIPS: document.querySelector('.new-color[data-jscolor*="CHIPS"]').jscolor.toHEXString().toUpperCase(),
                PLASMA: document.querySelector('.new-color[data-jscolor*="PLASMA"]').jscolor.toHEXString().toUpperCase(),
                MONEY: document.querySelector('.new-color[data-jscolor*="MONEY"]').jscolor.toHEXString().toUpperCase(),
                UI: {
                    TEXT_LIGHT: document.querySelector('.new-color[data-jscolor*="UI_TEXT_LIGHT"]').jscolor.toHEXString().toUpperCase(),
                    TEXT_DARK: document.querySelector('.new-color[data-jscolor*="UI_TEXT_DARK"]').jscolor.toHEXString().toUpperCase(),
                },
                BOSSES: {
                    bl_ox: document.querySelector('.new-color[data-jscolor*="BOSSES_bl_ox"]').jscolor.toHEXString().toUpperCase(),
                },
                SET: {
                    Default: document.querySelector('.new-color[data-jscolor*="SET_Default"]').jscolor.toHEXString().toUpperCase(),
                },
                // Add other groups similarly...
            };

            // Function to convert the palette object to Lua table string
            function toLuaTable(obj, indent) {
                let lua = '';
                const indentation = '    '.repeat(indent);
                if (typeof obj === 'object') {
                    lua += '{\n';
                    for (let key in obj) {
                        lua += `${indentation}${key} = `;
                        if (typeof obj[key] === 'object') {
                            lua += toLuaTable(obj[key], indent + 1);
                        } else {
                            lua += `HEX('${obj[key]}'),\n`;
                        }
                    }
                    lua += `${indentation.slice(4)}}`;
                } else {
                    lua += `HEX('${obj}')`;
                }
                return lua;
            }

            let luaScript = 'return ' + toLuaTable(palette, 0);

            // Create a Blob object representing the Lua file
            const blob = new Blob([luaScript], { type: 'text/plain' });
            const link = document.createElement('a');
            link.href = URL.createObjectURL(blob);
            link.download = 'trance_palette.lua';
            document.body.appendChild(link);
            link.click();
            document.body.removeChild(link);
        }
    </script>
</body>
</html>
